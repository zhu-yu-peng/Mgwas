# clinical-micro-meta-integration

These scripts accompany the Nature Protocol: 'A computational framework for conducting a three-pronged association study to integrate high-throughput ‘-omics’ datasets for the identification of potential mechanistic links' (2018), and corresponds to the procedural sections in the protocol paper.

This Nature Protocol paper is based on our original analysis of MetaHIT data in Pedersen, H. K. et al. 'Human gut microbes impact host serum metabolome and insulin sensitivity'. Nature 535, 376–381 (2016)., and is intended to allow adaptations for analogous work on other datasets.

### Provided data

This repository contains all input data files used as a demonstration example in the paper and, for reference, also examples of all types of result files generated by the code when using the supplied input data. The content of these files is further described in the Nature Protocol paper.

### Getting started

Ensure the following R-packages (including their dependencies, some of which should be installed via Bioconductor) are installed and loaded correctly. The analysis was tested using R 3.3.3. If packages are available under another version, it should run, but specifics of the implementation of each package may change results slightly:

- xlsx - Saving to spreadsheet
- data.table - Fast read of large files into R 
- WGCNA - Clustering software.
- flashClust - Clustering software
- ppcor - Partial Spearman correlations, for confounder analysis.
- gplots - Plotting
- cowplot - Plotting; to arrange several plots on the same page
- ggplot2 - Plotting
- plyr - Data transformations

Under the working directory, the below three subdirectories are assumed to exist: 

* r-code: containing the 22 R-scripts
* data: containing input files (i.e. all files (unzipped) from the 'example_input.zip'-file).
* results: location of output files

To run the code, simply source the protocol_main.R script from within R (after specifying the working directory within the script) – or better work though the procedural part of the paper step-by-step.